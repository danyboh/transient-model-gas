function [Z, Mm, Cv] = Fvnic(p, T, x)
% Fvnic: обчислення коефіцієнта стисливості Z для природного газу
% за стандартом VNIC (ГОСТ 30319.2-96)
% p - тиск у МПа, T - температура у К, x - вектор мольних часток (1x8)

% Значення газової сталої
R = 8.31451;  % Дж/(моль*К)

% Спрощена модель: Z = 1 + A*p - B*T (псевдоапроксимація)
% У реальній реалізації слід підставити аналітичні вирази з ГОСТ
A = 0.005; B = 0.001;
Z = 1 + A * p - B * T;

% Молярна маса (приблизна лінійна комбінація)
M = [16.043, 30.07, 44.097, 58.12, 58.12, 28.01, 44.01, 34.08];
Mm = sum(x .* M);

% Теплоємність при сталому об'ємі (приблизно)
Cv = 1.5 * R / Mm * 1000; % [Дж/(кг*К)]

end
