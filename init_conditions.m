function [U0, x] = init_conditions(~, Nx)
% Початкові умови: U0 = [rho; rho*u; rho*e] у кожній комірці

% Фізичні параметри
L = 1000;     % довжина трубопроводу [м]
Nx = max(Nx, 200);  % кількість комірок не менше 200
x = linspace(0, L, Nx);  % координатна сітка

p0 = 5.5e6;  % тиск на вході [Па]
pL = 5.0e6;  % тиск на виході [Па]
T0 = 288.15; % температура [К]
R = 518.3;   % газова стала [Дж/(кг·К)] для природного газу
x_mol = [0.94 0.02 0.01 0.005 0.005 0.01 0.008 0.002]; % склад газу

% Отримання Z, Mm, Cv
[Z, Mm, Cv] = Fvnic(p0/1e6, T0, x_mol);  % p в МПа (орієнтовне Z для всієї труби)

% Побудова лінійного профілю тиску
p_profile = linspace(p0, pL, Nx);        % тиск від p0 до pL уздовж трубопроводу
rho_profile = p_profile ./ (Z * R * T0); % густина в кожній точці

% Побудова розподілу швидкості: лінійне збільшення від 1 до 3 м/с
u_profile = linspace(1, 3, Nx);

% Обчислення питомої енергії в кожній точці
e_profile = Cv * T0 + 0.5 * u_profile.^2;

U0 = zeros(3, Nx);
U0(1, :) = rho_profile;
U0(2, :) = rho_profile .* u_profile;
U0(3, :) = rho_profile .* e_profile;

end
